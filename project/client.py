import json
import requests

API_ENDPOINT = 'http://10.4.21.156'
MAX_DEG = 11


def urljoin(root, path=''):
    if path:
        root = '/'.join([root.rstrip('/'), path.rstrip('/')])
    return root


def send_request(id, vector, path):
    api = urljoin(API_ENDPOINT, path)
    vector = json.dumps(vector)
    response = requests.post(api, data={'id': id, 'vector': vector}).text
    if "reported" in response:
        print(response)
        exit()

    return response


def get_errors(id, vector):
    for i in vector:
        assert 0 <= abs(i) <= 10
    assert len(vector) == MAX_DEG

    return json.loads(send_request(id, vector, 'geterrors'))


def get_overfit_vector(id):
    return json.loads(send_request(id, [0], 'getoverfit'))


def submit(id, vector):
    """
    used to make official submission of your weight vector
    returns string "successfully submitted" if properly submitted.
    """
    for i in vector:
        assert 0 <= abs(i) <= 10
    assert len(vector) == MAX_DEG
    return send_request(id, vector, 'submit')


# Replace 'SECRET_KEY' with your team's secret key (Will be sent over email)
if __name__ == "__main__":
    # 1
    # vec = [0.0, -5.498623626605807e-17, 1.0710572500094568e-05, 9.162639673800067e-08, -0.488224282309279, 1.503261394372703e-20,
    #        6.979320815739931e-20, 4.5871138220146244e-12, 2.100124387118824e-12, -4.6930862102660125e-12, -1.814498505183458e-11]
    # Error around 1.5e12
    # 2
    # vec = [0.0, -7.036530793256614e-17, 8.190293699420056e-06, 9.169178213323054e-08, -0.5675880864964316, 1.2691328044590184e-20,
    #        6.212489781204206e-20, 4.25125587563371e-12, 2.333939393981563e-12, -4.265359988654308e-12, -1.3583568917940034e-11]
    # Error around 1.38e12
    # 3
    # vec = [0.0, -5.431987843423241e-17, 1.3239767111253694e-05, 1.0718326376963613e-07, -0.6052635114299969, 1.5833859453747286e-20,
    #        8.312210574165536e-20, 4.385594023517787e-12, 2.3063103570781153e-12, -5.34037552365445e-12, -1.0256566832203762e-11]
    # Error around 1.35e12
    # 4
    # vec = [0.0, -5.105223582356095e-17, 1.1502848718805467e-05, 1.0453861891304721e-07, -0.6602970352859908, 1.826048426945547e-20,
    #        1.0271695115197742e-19, 3.6009629713447435e-12, 1.7683040901200354e-12, -5.158054865509138e-12, -4.982287992001061e-12]
    # Error around 1.31e12
    # 5
    # vec = [0.0, -5.834512082832662e-17, 1.2359722513838768e-05, 8.306645092458653e-08, -0.7207912814849577, 2.3122938977909927e-20,
    #        6.653886008994901e-20, 2.8479654379126543e-12, 1.999218266794433e-12, -3.457200141011647e-12, -1.9928635588870585e-12]
    # Error 1163121758347.948
    # 6
    # vec = [0.0, -7.015094785366528e-17, 1.471053739655598e-05, 9.10856158708612e-08, -0.7135960159971697, 2.0357319471194072e-20,
    #        7.506491700896282e-20, 3.1541745216441693e-12, 2.0744379563753377e-12, -3.481821629257634e-12, -1.454094165042438e-12]
    # Error around 1.21e12
    # 7
    # vec = [0.0, -6.316872320642628e-17, 1.8836776058298892e-05, 8.060944037151901e-08, -0.7065913828377662, 2.4316193883317236e-20,
    #        8.181646765766872e-20, 3.2826677053101147e-12, 2.2814911326805776e-12, -3.4390504427321506e-12, -1.0356973448532384e-12]
    # Error 1259278394406.8762
    # 8
    # vec = [0.0, -4.8788842059768664e-17, 1.3104730176488175e-05, 6.781667634502293e-08, -0.7239609875065804, 3.8612642960301253e-20,
    #        1.6509275180712835e-19, 2.47275796866213e-12, 1.7070521544051872e-12, -3.171887208166473e-12, -3.0353583198642455e-13]
    # Error 1212022104256.569
    # 9
    # vec = [0.0, -3.699768666811759e-17, 1.0622739797151301e-05, 5.495089476191611e-08, -0.721320728586856, 2.821020716223916e-20,
    #        1.435989154023416e-19, 2.9445880184707308e-12, 1.4429046996995635e-12, -2.124467439611571e-12, -1.2606407113426688e-13]
    # Error 1229139507023.1084
    # 10
    # vec = [-0.10041796437015839, -1.403893245060537e-17, 8.531230864830667e-06, 2.0662279972462333e-08, -0.7268623708541062,
    #        2.7965673259545584e-20, 1.36309287647868e-19, 1.2613644000838135e-12, 1.258517900612035e-12, -1.0846497512340126e-12, -3.51525514972033e-14]
    # Error 1208030331218.608
    # 11 (Submitted by \_'o'_/)
    # vec = [4.419859871000819, -7.244540230409167e-18, 5.041609072746322e-05, 4.585833699415795e-09, -1.2569440370638485, 3.137818925906133e-20,
    #        1.4237483028448348e-20, 4.4923842043194653e-13, 1.047563234114354e-07, -7.166855338759773e-15, -6.687395514486135e-16]
    # Error unknown. But better than vector 10
    # 12 (Submitted by Room543)
    # vec = [8.400816190160068, -8.543334207484897e-18, 2.5131083559736733e-05, 6.3214096731091655e-09, -1.2582264023072198, 2.6875593770038968e-20,
    #        1.0204703052058756e-20, 4.932197855871359e-13, 1.0664583512488755e-07, -6.594895374501172e-15, -1.8155052779222755e-15]
    # Error unknown. Better than vector 10. But not better than vector 11.
    # 13 (Submitted by Benito)
    # vec = [7.171078847823947, -8.68686628550441e-18, 2.002460171521368e-05, 4.24430907951324e-09, -1.2582264023072198, 2.6291031379133173e-20, 8.392183212521756e-21,
    #        4.4610713543053983e-13, 1.0664583512488755e-07, -1.10963025441954e-14, -3.746757535936748e-15]
    # Error unknown. Better than vector 12. But not better than vector 11.
    # 14 (Submitted by \_'o'_/)
    # vec = [5.161145836825994, -1.0925410501054572e-17, 3.322964423155525e-05, 7.462903486641638e-09, -1.2582264023072198, 1.6258529530903175e-20,
    #        1.100285747092143e-20, 3.582598284744896e-13, 1.0664583512488755e-07, -1.7608916660136258e-14, -9.244372131382356e-15]
    # Error unknown. But better than vector 10, 12 and 13
    # 15 (Submitted by \_'o'_/)
    # vec = [5.383065829137554, -8.882335286625956e-18, 2.8411410528790527e-05, 5.576578950563527e-09, -1.2582264023072198, 1.932917918322454e-20,
    #        9.120939326319228e-21, 3.7528083316680035e-13, 1.0664583512488755e-07, -9.591760934121213e-15, -1.111121357578357e-14]
    # Error unknown. But better than vector 10, 12 and 13
    # 16 (Submitted by \_'o'_/)
    # vec = [4.184070668290893, -7.850456642755217e-18, 2.6623847537377427e-05, 5.036305913703038e-09, -1.2582264023072198, 1.9616216160068823e-20,
    #        3.7313992965337805e-21, 4.931505123879456e-13, 1.0664583512488755e-07, -8.623342104104946e-15, -1.2760055435313701e-14]
    # Error unknown. But better than vector 10, 12 and 13
    # 17 (Submitted by Room543)
    # vec = [6.8844350902206175, -9.794730566767862e-18, 1.828988602880485e-05, 4.855622630975936e-09, -1.2486049836655162, 1.834386010950058e-20,
    #        4.35552545923755e-21, 1.2062971267624513e-13, 1.0574888606925636e-07, -1.5686936339548276e-14, -1.3673296891880275e-14]
    # Error unknown. But worse than 12
    # 18 (Submitted by Benito)
    # vec = [6.721321544621738, -1.1877921234621972e-17, 6.8904241546123365e-06, 5.7470406913645966e-09, -1.2486049836655162, 4.4656815455991816e-20,
    #        4.025632784891203e-21, 1.4104150950287807e-13, 1.0563239599063873e-07, -8.756274436367583e-15, -8.692630883341574e-15]
    # Error unknown. But worse than 12 and better than 17
    # 19 (Submitted by \_'o'_/)
    vec = [2.6818812113350003, -4.314964270135856e-18, 4.057299232887971e-06, 6.826389375060461e-09, -1.2486049836655162, 1.5553402114948158e-19,
           1.3314811505159597e-20, 6.85844393372265e-14, 1.056441508086754e-07, -3.2542763496813605e-15, -2.7153269412270014e-15]
    team_id = 'w6zmexNbwRHCKVKxAjTMN7kU4SOsMsoXL5cEAZKoHfvi0F0tvY'  # \_'o'_/
    # team_id = 'gCA6CLYnqUty40i93xmxPiCuNFk8wRA2wjui6iqDFxtDgHxhnb'  # Room543
    # team_id = 'D6eRVbg8gPo35mU6bGt1rYYlPJgknnBSqiSK9wLgDLPPaI4AQ8'  # Benito
    print(submit(team_id, vec))
